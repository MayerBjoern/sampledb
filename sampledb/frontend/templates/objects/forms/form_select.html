<div class="form-group{% if id_prefix+'_text' in errors %} has-error{% elif id_prefix+'_text' in form_data %} has-success{% endif %} row" style="padding-right:0.75em">
  <label class="control-label col-md-3 {% if schema.title and is_required %}required-label{% endif %}">{{ schema.title | get_translated_text }}</label>
  <div class="col-md-9">
  <select class="form-control selectpicker" name="{{ id_prefix }}_text">
  {% if form_data.get(id_prefix+'_text', '') != '' or (data is not none and data.get('text', '') != '') or 'default' in schema %}
    {% if not is_required %}
      <option value="">&mdash;</option>
    {% endif %}
  {% else %}
  <option selected="selected" value="">&mdash;</option>
  {% endif %}
  {% for option in schema.choices %}
    {% if id_prefix+'_text' in form_data %}
      {% if form_data[id_prefix+'_text'] == option %}
      <option value="{{ option }}" selected="selected">{{ option | get_translated_text }}</option>
      {% else %}
      <option value="{{ option }}">{{ option | get_translated_text }}</option>
      {% endif %}
    {% elif data is not none and "text" in data %}
      {% if data.text == option %}
      <option value="{{ option }}" selected="selected">{{ option | get_translated_text }}</option>
      {% else %}
      <option value="{{ option }}">{{ option | get_translated_text }}</option>
      {% endif %}
    {% else %}
      {% if 'default' in schema and schema['default'] == option %}
      <option value="{{ option }}" selected="selected">{{ option | get_translated_text }}</option>
      {% else %}
      <option value="{{ option }}">{{ option | get_translated_text }}</option>
      {% endif %}
    {% endif %}
  {% endfor %}
  </select>
  {% if id_prefix+'_text' in object_errors %}<span class="help-block"><strong>{{ _('Error:') }}</strong> {{ object_errors[id_prefix+'_text'] }}</span>{% endif %}
  {% if 'note' in schema %}<span class="help-block"><strong>{{ _('Note:') }}</strong> {{ schema['note'] | get_translated_text }}</span>{% endif %}
  </div>
</div>
